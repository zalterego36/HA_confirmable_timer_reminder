alias: Handle Toilet Cleaning Confirmation Response
description: Handles the user's response to the toilet cleaning reminder.
trigger:
  - platform: event
    event_type: mobile_app_notification_action
    event_data:
      action: "YES_clean_toilet"
  - platform: event
    event_type: mobile_app_notification_action
    event_data:
      action: NO_clean_toilet
condition: []
action:
  - choose:
      - conditions:
          - condition: template
            value_template: "{{ trigger.event.data.action == 'YES_clean_toilet' }}"
        sequence:
          - service: input_datetime.set_datetime
            target:
              entity_id: input_datetime.toilet_last_cleaned
            data:
              datetime: "{{ now().strftime('%Y-%m-%d %H:%M:%S') }}"
      - conditions:
          - condition: template
            value_template: "{{ trigger.event.data.action == 'NO_clean_toilet' }}"
        sequence:
          - service: logbook.log
            data:
              name: Toilet Cleaning
              message: User indicated the toilet was not cleaned.
mode: single
